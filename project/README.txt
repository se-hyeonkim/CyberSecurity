1. 프로젝트 개요

프로젝트명: CAUBOX (영화 예매 시스템)
설명: 본 프로젝트는 웹 기반의 영화 예매 시스템으로, 사용자들이 영화 정보를 탐색하고, 상영 일정을 확인하여 좌석을 예매할 수 있도록 구현되었습니다. 관리자는 영화 등록, 상영 일정 등록, 영화 정보 수정/삭제, 회원 및 우수 고객 관리를 수행할 수 있습니다.
주요 기능:
회원가입 및 로그인/로그아웃 기능
일반 회원과 관리자 역할 구분 및 권한별 페이지/기능 접근 제어
영화 목록 조회 (예매율 순)
영화 상세 정보 조회
영화 예매 및 예매 취소
마이페이지에서 예매 내역 및 마일리지, VIP 여부 확인
관리자 기능: 영화 등록, 상영 일정 등록, 영화 정보 수정/삭제
관리자 기능: 회원 목록 조회 및 삭제
관리자 기능: 우수 고객 (VIP) 및 일반 고객 목록 조회

2. 데이터베이스 설정 및 초기화

데이터베이스명: mydb
사용자명: root
비밀번호: 0929

3. 로그인 정보

일반 사용자:
회원가입 페이지에서 직접 회원가입하여 로그인할 수 있습니다.
(초기 데이터가 있다면) [학번].sql에 포함된 일반 사용자 계정으로 로그인할 수 있습니다.
관리자 아이디: admin
	  비밀번호: admin
추가 질문: 반려견 이름은?
답변: 락희
(관리자 계정으로 로그인 시도 후, 추가 질문 입력 창이 뜨면 '락희' 입력)

4. 구현 기능 및 특징

보안 취약점 대처 방안:
SQL Injection 방어: 데이터베이스 쿼리 실행 시 mysqli_prepare() 및 mysqli_stmt_bind_param()을 활용한 Prepared Statement를 적극적으로 사용하여, 사용자 입력값이 SQL 쿼리 구조를 변경하는 것을 방지했습니다.
XSS (Cross-Site Scripting) 방어: 사용자로부터 입력받은 데이터를 HTML에 출력할 때 htmlspecialchars() 함수를 사용하여, 스크립트 코드나 악성 HTML 태그가 실행되지 않도록 HTML 엔티티로 변환했습니다.
관리자 권한 분리: $_SESSION['role']을 통해 관리자(admin)와 일반 사용자를 명확히 구분하고, 관리자 전용 기능(영화/상영 등록, 수정/삭제, 회원 관리 등)에는 일반 사용자의 접근을 차단했습니다.
세션 관리: session_start()로 세션을 안전하게 시작하고, logout.php에서 session_destroy()를 통해 세션을 올바르게 종료합니다.
관리자 2단계 인증: admin 계정 로그인 시 아이디/비밀번호 외에 반려견 이름 추가 질문에 대한 정답을 입력해야 최종 로그인이 완료되도록 하여 보안을 강화했습니다.
다양한 기능 구현:
마일리지 시스템 및 우수 고객(VIP) 관리:
영화 예매 시 마일리지 100점 자동 적립, 예매 취소 시 100점 차감 (0점 이하 방지).
마이페이지에서 사용자의 현재 마일리지 및 전체 사용자 마일리지 평균을 기준으로 VIP 여부를 실시간으로 판단하여 표시합니다.
관리자 페이지에서는 마일리지 평균을 기준으로 VIP 고객과 일반 고객을 분리하여 조회할 수 있습니다.
동적 예매율 반영:
movies 테이블에 total_reservations_count (총 예매된 좌석 수)와 total_screenings_seats (총 상영 가능 좌석 수) 컬럼을 추가했습니다.
예매/취소 시 total_reservations_count가, 상영 등록 시 total_screenings_seats가 실시간으로 업데이트됩니다.
메인 페이지(무비차트)에서는 이 두 컬럼을 사용하여 (총 예매된 좌석 수 / 총 상영 가능 좌석 수) * 100으로 예매율을 동적으로 계산하여 표시합니다.
다중 상영 일정 선택:
영화 상세 페이지에서 영화별 여러 상영 일정이 있을 경우, 예매 페이지에서 드롭다운 메뉴를 통해 원하는 상영 일시를 선택할 수 있도록 구현했습니다. 상영 일시 변경 시 해당 상영의 좌석 현황이 동적으로 업데이트됩니다.
회원 정보 관리: 마이페이지에서 회원이 자신의 정보를 수정할 수 있으며, 선호 장르, 성별, 연락처, 생년월일 등 다양한 정보를 관리합니다.
회원 탈퇴 기능: 일반 회원은 자신의 계정을 탈퇴할 수 있습니다. (관리자는 탈퇴 불가)

5. Join 및 Subquery 활용

JOIN 활용:
mypage.php: 사용자의 예매 내역을 가져올 때 reservations, screenings, movies 테이블을 JOIN하여 영화 제목, 상영 시간, 좌석 번호 등을 함께 조회합니다.
cancel_reservation.php: 예매 취소 시 해당 예매가 어떤 영화에 대한 것인지 확인하기 위해 reservations와 screenings 테이블을 JOIN합니다.
Subquery 활용:
vip_list.php: VIP 고객을 판별할 때 info 테이블 내에서 전체 사용자 마일리지 평균을 계산하는 Subquery를 사용하여 각 회원의 마일리지와 비교합니다.
index.php: 영화 예매율을 계산할 때 total_reservations_count와 total_screenings_seats를 사용하여 예매율을 계산하는 Subquery (CASE WHEN 포함)를 활용합니다.